<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>dco-me documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">dco-me documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>FileSystemFlags</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/campaign/campaign.component.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#create">create</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#exclusive">exclusive</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="create"></a>
                                        <span class="name"><b>create</b><a href="#create"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>create:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="exclusive"></a>
                                        <span class="name"><b>exclusive</b><a href="#exclusive"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>exclusive:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit } from &#x27;@angular/core&#x27;;
import { HttpClient, HttpHeaders } from &#x27;@angular/common/http&#x27;;
import { ApiService } from &#x27;../api.service&#x27;;
import { DataSource } from &#x27;@angular/cdk/collections&#x27;;
import { Router, ActivatedRoute, NavigationExtras } from &quot;@angular/router&quot;;
import { Observable } from &#x27;rxjs&#x27;;
import * as _ from &quot;lodash&quot;;
import { tap, catchError } from &#x27;rxjs/operators&#x27;;
import { of } from &#x27;rxjs/observable/of&#x27;;

import {AbstractControl,  FormControl, FormGroupDirective, FormBuilder, FormGroup, FormArray, NgForm, Validators } from &#x27;@angular/forms&#x27;;

import { BehaviorSubject } from &#x27;rxjs&#x27;;

import { Disclaimers } from &#x27;../lib/service/data/disclaimers.model&#x27;;

import { UploadEvent, UploadFile } from &#x27;ngx-file-drop&#x27;;

import { Campaign } from &#x27;../lib/service/data/campaign&#x27;;

@Component({
  selector: &#x27;app-campaign&#x27;,
  templateUrl: &#x27;./campaign.component.html&#x27;,
  styleUrls: [&#x27;./campaign.component.scss&#x27;]
})

export class CampaignComponent implements OnInit {

  campaignForm: FormGroup;
  id:string&#x3D;&#x27;&#x27;;
  dealerid: string&#x3D;&#x27;&#x27;;
  dealerName: string&#x3D;&#x27;&#x27;;
  campaignid:string&#x3D;&#x27;&#x27;;
  campaignname:string&#x3D;&#x27;&#x27;;
  adid:string&#x3D;&#x27;&#x27;;
  adname:string&#x3D;&#x27;&#x27;;
  creativeid:string&#x3D;&#x27;&#x27;;
  campaignadtype:string&#x3D;&#x27;&#x27;;
  campaignexpdate:string&#x3D;&#x27;&#x27;;
  adexpdate:string&#x3D;&#x27;&#x27;;
  publisher:string&#x3D;&#x27;&#x27;;
  creativeobject: Object;
  vehicleid: String&#x3D;&#x27;&#x27;;
  vehiclevin: String&#x3D;&#x27;&#x27;;
  make: String&#x3D;&#x27;&#x27;;
  model: String&#x3D;&#x27;&#x27;;
  year: String&#x3D;&#x27;&#x27;;
  color: String&#x3D;&#x27;&#x27;;
  trim: String&#x3D;&#x27;&#x27;;
  vehicleodometer: String&#x3D;&#x27;&#x27;;
  vehicletitle: String&#x3D;&#x27;&#x27;;
  vehicleprice: String&#x3D;&#x27;&#x27;;
  pacode: String&#x3D;&#x27;&#x27;;
  postalCode: String&#x3D;&#x27;&#x27;;
  disclaimers:  [{
    disclaimer: String;
  }];

  public valueSearch: string &#x3D; &#x27;&#x27;;
  public search: string &#x3D; null;
  campaigns: any;
  groupedCampaignIds: any;
  groupedCampaigns: any;
  private selectedCampaign: Campaign;

  data: Disclaimers[] &#x3D; [ { disclaimer: new String } ];
  dataSource &#x3D; new BehaviorSubject&lt;AbstractControl[]&gt;([]);
  displayColumns &#x3D; [&#x27;disclaimer&#x27;];
  rows: FormArray &#x3D; this.fb.array([]);


  constructor(
    private api: ApiService,
    private router: Router,
    private activeRoute: ActivatedRoute,
    private http: HttpClient,
    private formBuilder: FormBuilder,
    private fb: FormBuilder
        
    ){
      this.activeRoute.queryParams.subscribe(params &#x3D;&gt; {
        this.search &#x3D; _.lowerCase(params[&quot;search&quot;]);

          if(this.search !&#x3D; undefined){
            this.valueSearch &#x3D; this.search;
        }
      });
    }

    ngOnInit() {

      this.api.getCampaigns()

        .subscribe(res &#x3D;&gt; {

        this.campaigns &#x3D; res;

        this.groupedCampaigns &#x3D; _.groupBy(this.campaigns, campaign&#x3D;&gt;campaign.campaignid);

        this.groupedCampaignIds &#x3D; Object.keys(this.groupedCampaigns);

        this.selectedCampaign &#x3D;  this.groupedCampaignIds[0];

        this.data &#x3D; this.groupedCampaigns[this.groupedCampaignIds[0]][0].disclaimers;
      
        this.data.forEach((d: Disclaimers) &#x3D;&gt; this.addRow(d, false));
        
        this.getCampaign(this.groupedCampaigns, this.groupedCampaignIds[0], 0);

      }, err &#x3D;&gt; {
        console.log(err);
        if(err.status &#x3D;&#x3D;&#x3D; 401) {
          this.router.navigate([&#x27;login&#x27;]);
        }
      });

      this.campaignForm &#x3D; this.formBuilder.group({
        &#x27;dealerid&#x27; : [null],
        &#x27;dealerName&#x27; : [null],
        &#x27;campaignid&#x27; : [null, Validators.required],
        &#x27;campaignname&#x27; : [null, Validators.required],
        &#x27;adid&#x27; : [null, Validators.required],
        &#x27;adname&#x27; : [null, Validators.required],
        &#x27;creativeid&#x27; : [null, Validators.required],
        &#x27;campaignadtype&#x27; : [null],
        &#x27;campaignexpdate&#x27; : [null, Validators.required],
        &#x27;adexpdate&#x27; : [null, Validators.required],
        &#x27;publisher&#x27; : [null],
        &#x27;creativeobject&#x27; :  [null],
        &#x27;vehicleid&#x27;:  [null],
        &#x27;vehiclevin&#x27;:  [null],
        &#x27;make&#x27;:  [null, Validators.required],
        &#x27;model&#x27;:  [null, Validators.required],
        &#x27;year&#x27;:  [null, Validators.required],
        &#x27;color&#x27;:  [null, Validators.required],
        &#x27;trim&#x27;:  [null],
        &#x27;vehicleodometer&#x27;:  [null],
        &#x27;vehicletitle&#x27;: [null],
        &#x27;vehicleprice&#x27;: [null],
        &#x27;pacode&#x27;: [null, Validators.required],
        &#x27;postalCode&#x27;: [null, Validators.required],
        &#x27;disclaimers&#x27;: this.rows
      });
      this.updateView();
    }

    
    private panelCollapse &#x3D; false;
    private selectedCampaignIndex &#x3D; 0;
    private selectedAd &#x3D; 0;

    getCampaign(allCampaigns, cId, ad) {

      console.log(&quot;allc&quot;, allCampaigns)
        this.id &#x3D; allCampaigns[cId][ad]._id;
        this.campaignForm.setValue({
          dealerid: allCampaigns[cId][ad].dealerid,
          dealerName: allCampaigns[cId][ad].dealerName,
          campaignid: allCampaigns[cId][ad].campaignid,
          campaignname: allCampaigns[cId][ad].campaignname,
          adid: allCampaigns[cId][ad].adid,
          adname: allCampaigns[cId][ad].adname,
          creativeid: allCampaigns[cId][ad].creativeid,
          campaignadtype: allCampaigns[cId][ad].campaignadtype,
          campaignexpdate: allCampaigns[cId][ad].campaignexpdate,
          adexpdate: allCampaigns[cId][ad].adexpdate,
          publisher: allCampaigns[cId][ad].publisher,
          creativeobject: this.files,
          vehicleid: allCampaigns[cId][ad].vehicleid,
          vehiclevin: allCampaigns[cId][ad].vehiclevin,
          make: allCampaigns[cId][ad].make,
          model: allCampaigns[cId][ad].model,
          year: allCampaigns[cId][ad].year,
          color: allCampaigns[cId][ad].color,
          trim: allCampaigns[cId][ad].trim,
          vehicleodometer: allCampaigns[cId][ad].vehicleodometer,
          vehicletitle: allCampaigns[cId][ad].vehicletitle,
          vehicleprice: allCampaigns[cId][ad].vehicleprice,
          pacode: allCampaigns[cId][ad].pacode,
          postalCode: allCampaigns[cId][ad].postalCode,
         disclaimers : allCampaigns[cId][ad].disclaimers
          });
    };

     selectCampaign(key, i){

      this.selectedCampaign &#x3D; key;
      this.selectedCampaignIndex &#x3D; i;
      this.selectedAd &#x3D; 0;
      this.data &#x3D; this.groupedCampaigns[key][0].disclaimers;
      this.removeEmptyRows();
      this.getCampaign(this.groupedCampaigns, key, this.selectedAd );
    };

    selectAd(a, i){

      this.selectedAd &#x3D; a;
      this.getCampaign(this.groupedCampaigns, this.selectedCampaign, this.selectedAd );
    };

    toggleCollapse(){
      this.panelCollapse &#x3D; !this.panelCollapse;
    };

    logout() {
      localStorage.removeItem(&#x27;jwtToken&#x27;);
      this.router.navigate([&#x27;login&#x27;]);
    };

    addRow(d?: Disclaimers, noUpdate?: boolean) {
      const row &#x3D; this.fb.group({
        &#x27;disclaimer&#x27;   : [d &amp;&amp; d.disclaimer ? d.disclaimer : null, []]
      });
      this.rows.push(row);
      if (!noUpdate) { this.updateView(); }
    }

    removeEmptyRows() {

      this.data &#x3D; _.filter(this.data, discs&#x3D;&gt;discs.disclaimer !&#x3D; null);
      this.data &#x3D; _.filter(this.data, discs&#x3D;&gt;discs.disclaimer.length &gt; 0);
      while (this.rows.length !&#x3D;&#x3D; 0) {
        this.rows.removeAt(0);
      }
      this.data.forEach((d: Disclaimers) &#x3D;&gt; this.addRow(d, false));
      this.updateView();
      this.campaignForm.updateValueAndValidity;
    }
  
    updateView() {
      this.dataSource.next(this.rows.controls);
    }

    public files: UploadFile[] &#x3D; [];
  
    public dropped(event: UploadEvent) {
      this.files &#x3D; event.files;
      for (const droppedFile of event.files) {
  
        // Is it a file?
        if (droppedFile.fileEntry.isFile) {
          const fileEntry &#x3D; droppedFile.fileEntry as FileSystemFileEntry;
          fileEntry.file((file: File) &#x3D;&gt; {
  
            // Here you can access the real file
            console.log(&quot;file&quot;, droppedFile.relativePath, file);
            this.campaignForm.controls[&#x27;creativeobject&#x27;].setValue(file);
            this.campaignForm.updateValueAndValidity;
  
          });
        } else {
          // It was a directory (empty directories are added, otherwise only files)
          const fileEntry &#x3D; droppedFile.fileEntry as FileSystemDirectoryEntry;
          console.log(&quot;folder&quot;, droppedFile.relativePath, fileEntry);
          this.campaignForm.controls[&#x27;creativeobject&#x27;].setValue(fileEntry);
          this.campaignForm.updateValueAndValidity;
        }
      }
    };
  
    public fileOver(event){
      console.log(event);
    };
  
    public fileLeave(event){
      console.log(event);
    } ;

    onFormSubmit(form:NgForm) {
      this.api.updateCampaign(this.id, form)
        .subscribe(res &#x3D;&gt; {
            let id &#x3D; res[&#x27;_id&#x27;];
            this.router.navigate([&#x27;/campaign-details&#x27;, id]);
          }, (err) &#x3D;&gt; {
            console.log(err);
          }
        );
    };
  
    deleteCampaign() {
      this.api.deleteCampaign(this.id)
        .subscribe(res &#x3D;&gt; {
          this.router.navigate([&#x27;/campaign-details&#x27;, this.id]);
          }, (err) &#x3D;&gt; {
            console.log(err);
          }
        );
    }
}

export class CampaignDataSource extends DataSource&lt;any&gt; {
  constructor(private api: ApiService) {
    super()
  }

  connect() {
    return this.api.getCampaigns();
  }

  disconnect() {

  }
}

export interface FileSystemEntry {
  name: string,
  isDirectory: boolean
  isFile: boolean
}

export interface FileSystemFileEntry extends FileSystemEntry {
  isDirectory: false
  isFile: true
  file(callback: (file: File) &#x3D;&gt; void): void
}

export interface FileSystemDirectoryReader {
  readEntries(
    successCallback: (result: FileSystemEntry[]) &#x3D;&gt; void,
    errorCallback?: (error: DOMError) &#x3D;&gt; void,
  ): void
}

export interface FileSystemFlags {
  create?: boolean
  exclusive?: boolean
}

export interface FileSystemDirectoryEntry extends FileSystemEntry {
  isDirectory: true
  isFile: false
  createReader(): FileSystemDirectoryReader
  getFile(
    path?: USVString,
    options?: FileSystemFlags,
    successCallback?: (result: FileSystemFileEntry) &#x3D;&gt; void,
    errorCallback?: (error: DOMError) &#x3D;&gt; void,
  ): void
  getDirectory(
    path?: USVString,
    options?: FileSystemFlags,
    successCallback?: (result: FileSystemDirectoryEntry) &#x3D;&gt; void,
    errorCallback?: (error: DOMError) &#x3D;&gt; void,
  ): void
}






</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'FileSystemFlags.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <script src="../js/menu-wc.js"></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
